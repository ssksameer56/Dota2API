version: '3.7'

services:
  graph-ql-api:
    context: .docker/
    image: graph-ql-api
    dockerfile: graph.dockerfile
    ports:
      - "8080:1000"
    volumes:
      - /app/logs:/Users/sameer/Code/Dota2API/logs"
    networks:
      - my-docker-net
    depends_on:
      - mysql-db
    environment:
      - DATABASE_HOST=docker-database
  grpc-api:
    context: .docker/
    image: grpc-api
    dockerfile: grpc.dockerfile
    ports:
      - "5050:2000"
    volumes:
      - /app/logs:/Users/sameer/Code/Dota2API/logs"
    networks:
      - my-docker-net
    depends_on:
      - mysql-db
    environment:
      - DATABASE_HOST=docker-database
  mysql-db:
    context: ./docker
    image: dota2api-db
    restart: always
    dockerfile: db.dockerfile
    networks:
      - my-docker-net
    volumes:
      - dota2vol:/var/lib/mysql
    environment:
     - MYSQL_ROOT_PASSWORD=root
     - MYSQL_DATABASE=DotaDatabase
networks:
  my-docker-net:
    driver: bridge
volumes:
  dota2vol:
